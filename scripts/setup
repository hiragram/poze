#!/bin/bash -eux

PROJECT_ROOT="$(cd "$(dirname "$0")/../" && pwd)"
SCRIPTS_DIR=$PROJECT_ROOT/scripts

cd $PROJECT_ROOT

if [ "${CI:-1}" != "TRUE" ]; then
    # Set environment variables
    set +x
    source environment
    set -x

    make gen
fi 

# Generate ChatGPT API key file
cat << EOS > ChatGPTAPI/Sources/ChatGPTAPI/APIKey.swift
// THIS FILE IS AUTOMATICALLY GENERATED. DO NOT EDIT.
let defaultAPIKey = "${CHATGPT_API_KEY:-""}"
EOS
